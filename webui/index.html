<!DOCTYPE html>
<html>
<head>
  <title>ESPAltherma Config</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" type="text/css" href="pico.min.css">
  <script src="main.js"></script>
  <style>
    .row-selected {
      background-color: rgb(233, 230, 230);
    }
  </style>
</head>
<body>
  <main class="container">
    <header><h1>ESPAltherma Config</h1></header>    
    <article>
      <form action="/save" method="post">
        <label for="ssid">WIFI SSID:</label>
        <input type="text" id="ssid" name="ssid" required/>

        <label for="ssid_password">WIFI Password:</label>
        <input type="password" id="ssid_password" name="ssid_password"/>
        <small>Leave empty for open networks</small> 

        <label for="ssid_staticip" >          
          <input type="checkbox" id="ssid_staticip" name="ssid_staticip" role="switch" onclick="show('staticip');"/>
          WIFI use static IP
        </label>

        <article id="staticip" style="display: none">
            <label for="ssid_ip">WIFI IP:</label>
            <input type="text" id="ssid_ip" name="ssid_ip"/>

            <label for="ssid_subnet">WIFI Subnet:</label>
            <input type="text" id="ssid_subnet" name="ssid_subnet"/>

            <label for="ssid_gateway">WIFI Gateway:</label>
            <input type="text" id="ssid_gateway" name="ssid_gateway"/>

            <label for="primary_dns">Primary DNS:</label>
            <input type="text" id="primary_dns" name="primary_dns"/>
            <small>Optional</small> 

            <label for="secondary_dns">Secondary DNS:</label>
            <input type="text" id="secondary_dns" name="secondary_dns"/>
            <small>Optional</small> 
        </article>

        <label for="mqtt_server">MQTT Server:</label>
        <input type="text" id="mqtt_server" name="mqtt_server" required/>

        <label for="mqtt_username">MQTT Username:</label>
        <input type="text" id="mqtt_username" name="mqtt_username" required/>

        <label for="mqtt_password">MQTT Password:</label>
        <input type="password" id="mqtt_password" name="mqtt_password" required/>

        <label for="mqtt_jsontable" >          
          <input type="checkbox" id="mqtt_jsontable" name="mqtt_jsontable" role="switch"/>
          MQTT use JSON Table
        </label>

        <label for="mqtt_use_onetopic" >          
          <input type="checkbox" id="mqtt_use_onetopic" name="mqtt_use_onetopic" role="switch" onclick="show('onetopic');"/>
          MQTT one Topic
        </label>

        <article id="onetopic" style="display: none;  ">
          <label for="mqtt_onetopic">MQTT one Topic:</label>
          <input type="text" id="mqtt_onetopic" name="mqtt_onetopic"/>
        </article>
        
        <label for="mqtt_port">MQTT Port:</label>
        <input type="number" id="mqtt_port" name="mqtt_port" required/>

        <label for="frequency">Frequency:</label>
        <input type="number" id="frequency" name="frequency" required/>

        <div class="grid">
          <!-- Markup example 1: input is inside label -->
          <label for="pin_rx">
            PIN RX
            <input type="number" id="pin_rx" name="pin_rx" required>
          </label>

          <label for="pin_tx">
            PIN TX
            <input type="number" id="pin_tx" name="pin_tx" required>
          </label>
        </div>

        <label for="pin_therm">
          PIN THERM
          <input type="number" id="pin_therm" name="pin_therm" required>
        </label>

        <label for="sg_enabled" >          
          <input type="checkbox" id="sg_enabled" name="sg_enabled" role="switch" onclick="show('smartgrid');"/>
          SmartGrid enabled
        </label>

        <article id="smartgrid" style="display: none">
          <div class="grid">
            <label for="pin_sg1">
              PIN SG1
              <input type="number" id="pin_sg1" name="pin_sg1">
            </label>
            
            <label for="pin_sg2">
              PIN SG2
              <input type="number" id="pin_sg2" name="pin_sg2">
            </label>
          </div>

          <label for="sg_relay_trigger" >          
            <input type="checkbox" id="sg_relay_trigger" name="sg_relay_trigger" role="switch"/>
            SG Relay high trigger
          </label>
          <small>Enable if the relay gets enabled when output is giht on SG Pins</small>
        </article>

        <label for="pin_enable_config">
          PIN CONFIG PAGE:
          <input type="number" id="pin_enable_config" name="pin_enable_config" required>
          <small>If the given pinnumber gets connected to ground, ESPAltherma will reboot again in the configuration mode (current mode).</small>
        </label>

        <div class="grid">
          <div>
            <label for="model">Model:</label>
            <select id="model" name="model" onclick="refreshModels()" onchange="refreshLanguages()">
              <option value="" selected>Select a model...</option>
            </select>

            <label for="language">Language:</label>
            <select id="language" name="language" onchange="updateParameters()">
              <option value="" selected>Select a language...</option>
            </select>

            <label for="parametersTable">Parameters:</label>
            <figure style="max-height: 500px">
              <table id="parametersTable" style="white-space: nowrap;">
                <tr>
                  <td>Name</td>                  
                  <td>Offset</td>
                  <td>RegID</td>
                  <td>ConvID</td>
                  <td>Data size</td>
                  <td>Data type</td>
                  <td>Value</td>
                </tr>                
              </table>
            </figure>

            <input type="button" onclick="loadData('parametersTable')" value="Load model values">
          </div>
          <div style="text-align: center; margin-top: 20pt;">
            <p><input type="button" onclick="addSelectedPredefinedParameters()" value="Add to selected parameters"></p>
            <p><input type="button" onclick="removeSelectedParameters()" value="Remove from selected parameters"></p>

            <details>
              <summary role="button">Add custom Parameter</summary>
              <p>
                <div class="grid">
                  <div>
                    <label for="offset">Offset:</label>
                    <input type="number" id="offset" name="offset"/>
                  </div>
                  <div>
                    <label for="regid">RegID:</label>
                    <input type="number" id="regid" name="regid"/>
                  </div>                  
                </div>
                <div class="grid">
                  <div >                    
                    <label for="convid">ConvID:</label>
                    <input type="number" id="convid" name="convid"/>
                  </div>
                  <div>                  
                    <label for="dataSize">Data size:</label>
                    <input type="number" id="dataSize" name="dataSize"/>
                  </div>
                  <div>
                    <label for="dataType">Data type:</label>
                    <input type="number" id="dataType" name="dataType"/>
                  </div>
                </div>              

                <label for="dataName">Data name:</label>
                <input type="text" id="dataName" name="dataName"/>

                <input type="button" onclick="addCustomParameter()" value="Add">
              </p>
            </details>
          </div>
          <div>
            <label for="selectedParametersTable">Selected Parameters:</label>            
            <figure style="max-height: 500px">
              <table id="selectedParametersTable" style="white-space: nowrap;">
                <tr>
                  <td>Name</td>                  
                  <td>Offset</td>
                  <td>RegID</td>
                  <td>ConvID</td>
                  <td>Data size</td>
                  <td>Data type</td>
                  <td>Value</td>
                </tr>                
              </table>
            </figure>

            <input type="button" onclick="loadData('selectedParametersTable')" value="Load parameter values">

            <label for="parametersFile">Upload Parameters file:</label>
            <input type="file" id="parametersFile" accept=".json" name="parametersFile"/>
            <small>Add a model config file to the predefined model list</small>

            <input type="button" onclick="uploadFile()" value="Upload">
          </div>
        </div>
        
        <p><input type="submit" value="SAVE" role="button" /></p>
      </form>
    </article>
  </main>
</body>
</html>