<!DOCTYPE html>
<html>
<head>
  <title>ESPAltherma Config</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" type="text/css" href="pico.min.css">
  <script src="main.js"></script>
  <style>
    .row-selected {
      background-color: rgb(233, 230, 230);
    }
  </style>
</head>
<body>
  <main class="container">
    <header><h1>ESPAltherma Config</h1></header>    
    <article>
      <form action="/save" method="post">
        <label for="ssid">WIFI SSID:</label>
        <input type="text" id="ssid" name="ssid" required/>

        <label for="ssid_password">WIFI Password:</label>
        <input type="password" id="ssid_password" name="ssid_password"/>
        <small>Leave empty for open networks</small> 

        <label for="ssid_staticip" >          
          <input type="checkbox" id="ssid_staticip" name="ssid_staticip" role="switch" onclick="show('staticip');"/>
          WIFI use static IP
        </label>

        <article id="staticip" style="display: none">
            <label for="ssid_ip">WIFI IP:</label>
            <input type="text" id="ssid_ip" name="ssid_ip"/>

            <label for="ssid_subnet">WIFI Subnet:</label>
            <input type="text" id="ssid_subnet" name="ssid_subnet"/>

            <label for="ssid_gateway">WIFI Gateway:</label>
            <input type="text" id="ssid_gateway" name="ssid_gateway"/>

            <label for="primary_dns">Primary DNS:</label>
            <input type="text" id="primary_dns" name="primary_dns"/>
            <small>Optional</small> 

            <label for="secondary_dns">Secondary DNS:</label>
            <input type="text" id="secondary_dns" name="secondary_dns"/>
            <small>Optional</small> 
        </article>

        <label for="mqtt_server">MQTT Server:</label>
        <input type="text" id="mqtt_server" name="mqtt_server" required/>

        <label for="mqtt_username">MQTT Username:</label>
        <input type="text" id="mqtt_username" name="mqtt_username" required/>

        <label for="mqtt_password">MQTT Password:</label>
        <input type="password" id="mqtt_password" name="mqtt_password" required/>

        <label for="mqtt_jsontable" >          
          <input type="checkbox" id="mqtt_jsontable" name="mqtt_jsontable" role="switch"/>
          MQTT use JSON Table
        </label>

        <label for="mqtt_use_onetopic" >          
          <input type="checkbox" id="mqtt_use_onetopic" name="mqtt_use_onetopic" role="switch" onclick="show('onetopic');"/>
          MQTT one Topic
        </label>

        <article id="onetopic" style="display: none;  ">
          <label for="mqtt_onetopic">MQTT one Topic:</label>
          <input type="text" id="mqtt_onetopic" name="mqtt_onetopic"/>
        </article>
        
        <label for="mqtt_port">MQTT Port:</label>
        <input type="number" id="mqtt_port" name="mqtt_port" required/>

        <label for="frequency">Frequency:</label>
        <input type="number" id="frequency" name="frequency" required/>

        <div class="grid">
          <!-- Markup example 1: input is inside label -->
          <label for="pin_rx">
            PIN RX
            <select id="pin_rx" name="pin_rx" data-pins required></select>
          </label>

          <label for="pin_tx">
            PIN TX
            <select id="pin_tx" name="pin_tx" data-pins required></select>
          </label>
        </div>

        <label for="pin_therm">
          PIN THERM
          <select id="pin_therm" name="pin_therm" data-pins required></select>
        </label>

        <label for="sg_enabled" >          
          <input type="checkbox" id="sg_enabled" name="sg_enabled" role="switch" onclick="show('smartgrid');"/>
          SmartGrid enabled
        </label>

        <article id="smartgrid" style="display: none">
          <div class="grid">
            <label for="pin_sg1">
              PIN SG1
              <select id="pin_sg1" name="pin_sg1" data-pins></select>
            </label>
            
            <label for="pin_sg2">
              PIN SG2
              <select id="pin_sg2" name="pin_sg2" data-pins></select>
            </label>
          </div>

          <label for="sg_relay_trigger" >          
            <input type="checkbox" id="sg_relay_trigger" name="sg_relay_trigger" role="switch"/>
            SG Relay high trigger
          </label>
          <small>Enable if the relay gets enabled when output is giht on SG Pins</small>
        </article>

        <label for="pin_enable_config">
          PIN CONFIG PAGE:
          <select id="pin_enable_config" name="pin_enable_config" data-pins required></select>
          <small>If the given pinnumber gets connected to ground, ESPAltherma will reboot again in the configuration mode (current mode).</small>
        </label>

        <div class="grid">
          <div>
            <label for="model">Model:</label>
            <select id="model" name="model" onclick="refreshModels()" onchange="refreshLanguages()">
              <option value="" selected>Select a model...</option>
            </select>

            <label for="language">Language:</label>
            <select id="language" name="language" onchange="updatePresets()">
              <option value="" selected>Select a language...</option>
            </select>

            <label for="language">Preset Parameters:</label>
            <select id="presetParameters" name="presetParameters" onchange="updateParameters()">
              <option value="" selected>Select a preset...</option>
            </select>
          </div>          
          <div>            
            <label for="parametersFile">Upload Parameters file:</label>
            <input type="file" id="parametersFile" accept=".json" name="parametersFile"/>
            <small>Add a model config file to the predefined model list</small>

            <input type="button" onclick="uploadFile()" value="Upload">
          </div>
        </div>

        <article id="containerCustomParameters" style="display: none">
          <div class="grid">
            <div style="border: 0.1em; border-style: dashed; border-radius: 0.5em; padding: 0.3em; margin-bottom: 0.5em;">
              <label for="parametersTable">Parameters:</label>
              <figure style="max-height: 500px">
                <table id="parametersTable" style="white-space: nowrap;">
                  <tr>
                    <td>Name</td>                  
                    <td>Offset</td>
                    <td>RegID</td>
                    <td>ConvID</td>
                    <td>Data size</td>
                    <td>Data type</td>
                    <td>Value</td>
                  </tr>                
                </table>
              </figure>

              <input type="button" onclick="addSelectedPredefinedParameters()" value="Add to selected parameters">
              <input type="button" onclick="loadData('parametersTable')" value="Load model values">            
            </div>          
            <div style="border: 0.1em; border-style: dashed; border-radius: 0.5em; padding: 0.3em; margin-bottom: 0.5em;">
              <label for="selectedParametersTable">Selected Parameters:</label>            
              <figure style="max-height: 500px">
                <table id="selectedParametersTable" style="white-space: nowrap;">
                  <tr>
                    <td>Name</td>                  
                    <td>Offset</td>
                    <td>RegID</td>
                    <td>ConvID</td>
                    <td>Data size</td>
                    <td>Data type</td>
                    <td>Value</td>
                  </tr>                
                </table>
              </figure>

              <input type="button" onclick="removeSelectedParameters()" value="Remove from selected parameters">
              <input type="button" onclick="loadData('selectedParametersTable')" value="Load parameter values">            
            </div>
          </div>
          <div style="text-align: center; margin-top: 20pt">            
            
            <details>
              <summary role="button">Add custom Parameter</summary>
              <p>
                <div class="grid">
                  <div>
                    <label for="offset">Offset:</label>
                    <input type="number" id="offset" name="offset" min="0" max="31"/>
                  </div>
                  <div>
                    <label for="regid">RegID:</label>
                    <input type="number" id="regid" name="regid" min="0" max="127"/>
                  </div>              
                  <div >                    
                    <label for="convid">ConvID:</label>
                    <select id="convid" name="convid">
                      <option value="100">100</option>
                      <option value="101">101</option>
                      <option value="102">102</option>
                      <option value="103">103</option>
                      <option value="104">104</option>
                      <option value="105">105</option>
                      <option value="106">106</option>
                      <option value="107">107</option>
                      <option value="108">108</option>
                      <option value="109">109</option>
                      <option value="110">110</option>
                      <option value="111">111</option>
                      <option value="112">112</option>
                      <option value="113">113</option>
                      <option value="114">114</option>
                      <option value="115">115</option>
                      <option value="116">116</option>
                      <option value="117">117</option>
                      <option value="118">118</option>
                      <option value="119">119</option>
                      <option value="151">151</option>
                      <option value="152">152</option>
                      <option value="153">153</option>
                      <option value="154">154</option>
                      <option value="155">155</option>
                      <option value="156">156</option>
                      <option value="157">157</option>
                      <option value="158">158</option>
                      <option value="200">200</option>
                      <option value="201">201</option>
                      <option value="203">203</option>
                      <option value="204">204</option>
                      <option value="211">211</option>
                      <option value="217">217</option>
                      <option value="300">300</option>
                      <option value="301">301</option>
                      <option value="302">302</option>
                      <option value="303">303</option>
                      <option value="304">304</option>
                      <option value="305">305</option>
                      <option value="306">306</option>
                      <option value="307">307</option>
                      <option value="315">315</option>
                      <option value="316">316</option>
                    </select>
                  </div>
                  <div>                  
                    <label for="dataSize">Data size:</label>
                    <select id="dataSize" name="dataSize">
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                    </select>
                  </div>
                  <div>
                    <label for="dataType">Data type:</label>
                    <select id="dataType" name="dataType">
                      <option value="-1">-1</option>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                    </select>
                  </div>
                </div>              

                <label for="dataName">Data name:</label>
                <input type="text" id="dataName" name="dataName"/>

                <input type="button" onclick="addCustomParameter()" value="Add">
              </p>
            </details>
          </div>
        </article>
        
        <p><input type="submit" value="SAVE" role="button" /></p>
      </form>
    </article>
  </main>
</body>
</html>